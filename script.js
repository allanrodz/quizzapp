let questions = [
    {
        "question": "How many All-Ireland Senior Hurling Titles did Kilkenny win between 1960 and 2019?",
        "answers": [
            {"text": "11", "correct": false},
            {"text": "16", "correct": false},
            {"text": "22", "correct": true},
            {"text": "30", "correct": false}
        ]
    },
    {
        "question": "Which player won the Hurler of the Year Award three times?",
        "answers": [
            {"text": "D.J. Carey", "correct": false},
            {"text": "Henry Shefflin", "correct": true},
            {"text": "Eoin Larkin", "correct": false},
            {"text": "J.J. Delaney", "correct": false}
        ]
    },
    {
        "question": "How many All-Star Awards were shared among Kilkenny players since 1971?",
        "answers": [
            {"text": "95", "correct": false},
            {"text": "73", "correct": false},
            {"text": "195", "correct": true},
            {"text": "150", "correct": false}
        ]
    },
    {
        "question": "Who was Kilkenny's goalkeeper Hurler of the Year in 1967?",
        "answers": [
            {"text": "Ollie Walsh", "correct": true},
            {"text": "Noel Skehan", "correct": false},
            {"text": "Eoin Murphy", "correct": false},
            {"text": "James McGarry", "correct": false}
        ]
    },
    {
        "question": "Which Kilkenny player won 7 All-Star awards and the Hurler of the Year Award in 1982?",
        "answers": [
            {"text": "Ollie Walsh", "correct": false},
            {"text": "Eoin Murphy", "correct": false},
            {"text": "P.J. Ryan", "correct": false},
            {"text": "Noel Skehan", "correct": true}

        ]
    },
    {
        "question": "How many different positions did J.J. Delaney start in finals?",
        "answers": [
            {"text": "1", "correct": false},
            {"text": "3", "correct": false},
            {"text": "2", "correct": true},
            {"text": "4", "correct": false}
        ]
    },
    {
        "question": "Who scored 14 points in the 1963 All-Ireland final between Kilkenny and Waterford?",
        "answers": [
            {"text": "Eddie Keher", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "D.J. Carey", "correct": false},
            {"text": "T.J. Reid", "correct": false}
        ]
    },
    {
        "question": "Which player was known for a unique grip on the hurl and scored 1-3 in the 2006 final?",
        "answers": [
            {"text": "Aidan Fogarty", "correct": false},
            {"text": "Richie Hogan", "correct": false},
            {"text": "Eoin Larkin", "correct": true},
            {"text": "Henry Shefflin", "correct": false}
        ]
    },
    {
        "question": "How many goals did Pat Delaney score in 27 games for Kilkenny?",
        "answers": [
            {"text": "30", "correct": false},
            {"text": "15", "correct": false},
            {"text": "10", "correct": false},
            {"text": "22", "correct": true}

        ]
    },
    {
        "question": "Who patented the 'Delaney bounce'?",
        "answers": [
            {"text": "Eddie Keher", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Pat Delaney", "correct": true},
            {"text": "Richie Power", "correct": false}
        ]
    },
    {
        "question": "How many All-Ireland medals did Eddie Brennan win?",
        "answers": [
            {"text": "7", "correct": false},
            {"text": "9", "correct": true},
            {"text": "11", "correct": false},
            {"text": "5", "correct": false}
        ]
    },
    {
        "question": "Which player was Hurler of the Year in 2008?",
        "answers": [
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Eoin Larkin", "correct": true},
            {"text": "D.J. Carey", "correct": false},
            {"text": "Richie Hogan", "correct": false}
        ]
    },
    {
        "question": "Who scored 2-11 in the 1971 All-Ireland final?",
        "answers": [
            {"text": "Henry Shefflin", "correct": false},
            {"text": "T.J. Reid", "correct": false},
            {"text": "Eddie Keher", "correct": true},
            {"text": "Richie Hogan", "correct": false}
        ]
    },
    {
        "question": "Who won three All-Ireland medals from the centre forward position?",
        "answers": [
            {"text": "Henry Shefflin", "correct": false},
            {"text": "D.J. Carey", "correct": false},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "Richie Power (Jnr.)", "correct": true}

        ]
    },
    {
        "question": "Which player had a goal-scoring record of more than half his points total from 26 goals?",
        "answers": [
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Eddie Brennan", "correct": true},
            {"text": "T.J. Reid", "correct": false},
            {"text": "Richie Hogan", "correct": false}
        ]
    },
    {
        "question": "Who scored a goal just after half-time in the 2015 final?",
        "answers": [
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "T.J. Reid", "correct": true},
            {"text": "Richie Hogan", "correct": false}
        ]
    },
    {
        "question": "Who was selected at both full back and full forward in All-Ireland finals?",
        "answers": [
            {"text": "J.J. Delaney", "correct": false},
            {"text": "Pa Dillon", "correct": false},
            {"text": "Brian Cody", "correct": true},
            {"text": "Jim Lynch", "correct": false}
        ]
    },
    {
        "question": "Who had the longest puckouts in the game during his time?",
        "answers": [
            {"text": "Noel Skehan", "correct": false},
            {"text": "Ollie Walsh", "correct": true},
            {"text": "Eoin Murphy", "correct": false},
            {"text": "James McGarry", "correct": false}
        ]
    },
    {
        "question": "Which player was known for the 'Delaney bounce'?",
        "answers": [
            {"text": "Eddie Keher", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Richie Power", "correct": false},
            {"text": "Pat Delaney", "correct": true}

        ]
    },
    {
        "question": "Who won the Hurler of the Year award in 1967?",
        "answers": [
            {"text": "Noel Skehan", "correct": false},
            {"text": "Eoin Murphy", "correct": false},
            {"text": "Ollie Walsh", "correct": true},
            {"text": "James McGarry", "correct": false}
        ]
    },{
        "question": "Who was Kilkenny's goalkeeper and Hurler of the Year in 1967?",
        "answers": [
            {"text": "Noel Skehan", "correct": false},
            {"text": "Ollie Walsh", "correct": true},
            {"text": "Kevin Fennelly", "correct": false},
            {"text": "Eoin Murphy", "correct": false}
        ]
    },
    {
        "question": "Which Kilkenny player was known for a unique grip on the hurl and scored 1-3 in the 2006 final?",
        "answers": [
            {"text": "Aidan Fogarty", "correct": true},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "Eoin Larkin", "correct": false},
            {"text": "Henry Shefflin", "correct": false}
        ]
    },
    {
        "question": "Who captained Kilkenny to two All-Ireland victories in 1983 and 1992?",
        "answers": [
            {"text": "Martin Comerford", "correct": false},
            {"text": "Colin Fennelly", "correct": false},
            {"text": "Richie Power", "correct": false},
            {"text": "Liam Fennelly", "correct": true}

        ]
    },
    {
        "question": "Who scored Kilkenny's only goal in the 2003 final to seal the victory?",
        "answers": [
            {"text": "Martin Comerford", "correct": true},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "T.J. Reid", "correct": false}
        ]
    },
    {
        "question": "Which player won three All-Ireland medals and three All-Star awards all at full forward in the early seventies?",
        "answers": [
            {"text": "Kieran Purcell", "correct": true},
            {"text": "Richie Power", "correct": false},
            {"text": "Pat Delaney", "correct": false},
            {"text": "Eddie Keher", "correct": false}
        ]
    },
    {
        "question": "Who was awarded the Hurler of the Year in 1983 at the age of thirty-five?",
        "answers": [
            {"text": "Eddie Keher", "correct": false},
            {"text": "Frank Cummins", "correct": true},
            {"text": "Pat Henderson", "correct": false},
            {"text": "Brian Cody", "correct": false}
        ]
    },
    {
        "question": "Who had the ability to pass the ball accurately with his hurl one-handed?",
        "answers": [
            {"text": "Jackie Tyrrell", "correct": false},
            {"text": "Liam Simpson", "correct": false},
            {"text": "Jim Treacy", "correct": false},
            {"text": "Willie O'Connor", "correct": true}

        ]
    },
    {
        "question": "Which player scored a massive 2-11 in the 1971 All-Ireland final and still ended up on the losing side?",
        "answers": [
            {"text": "Eddie Keher", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "D.J. Carey", "correct": false},
            {"text": "Richie Hogan", "correct": false}
        ]
    },
    {
        "question": "Who scored 1-3 in the 2006 final with a unique grip on the hurl?",
        "answers": [
            {"text": "Aidan Fogarty", "correct": true},
            {"text": "Richie Hogan", "correct": false},
            {"text": "Eoin Larkin", "correct": false},
            {"text": "T.J. Reid", "correct": false}
        ]
    },
    {
        "question": "Who was named Hurler of the Year in 2008?",
        "answers": [
            {"text": "Eoin Larkin", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "D.J. Carey", "correct": false},
            {"text": "Eddie Brennan", "correct": false}
        ]
    },
    {
        "question": "Who captained Kilkenny in the three-in-a-row in 2008?",
        "answers": [
            {"text": "James 'Cha' Fitzpatrick", "correct": true},
            {"text": "Richie Hogan", "correct": false},
            {"text": "Michael Fennelly", "correct": false},
            {"text": "Tommy Walsh", "correct": false}
        ]
    },
    {
        "question": "Which Kilkenny player patented the 'Delaney bounce'?",
        "answers": [
            {"text": "Pat Delaney", "correct": true},
            {"text": "Eddie Keher", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Richie Power", "correct": false}
        ]
    },
    {
        "question": "Who scored over 100 league and championship goals?",
        "answers": [
            {"text": "Eddie Keher", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "D.J. Carey", "correct": false},
            {"text": "Richie Hogan", "correct": false}
        ]
    },
    {
        "question": "Who had a goal-scoring record of more than half his points total from 26 goals?",
        "answers": [
            {"text": "Eddie Brennan", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "T.J. Reid", "correct": false},
            {"text": "Richie Hogan", "correct": false}
        ]
    },
    {
        "question": "Who won Hurler of the Year in 1983 and is known for a powerful physique?",
        "answers": [
            {"text": "Frank Cummins", "correct": true},
            {"text": "Eddie Keher", "correct": false},
            {"text": "Pat Henderson", "correct": false},
            {"text": "Brian Cody", "correct": false}
        ]
    },
    {
        "question": "Who was known for scoring 1-3 in the 2006 final with a unique grip?",
        "answers": [
            {"text": "Aidan Fogarty", "correct": true},
            {"text": "Eoin Larkin", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Richie Hogan", "correct": false}
        ]
    },
    {
        "question": "Who was Kilkenny's top scorer in the championship with a total of 2-12 in 1979?",
        "answers": [
            {"text": "Mick 'Cloney' Brennan", "correct": true},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "Billy Fitzpatrick", "correct": false},
            {"text": "Richie Power", "correct": false}
        ]
    },
    {
        "question": "Who won the Man of the Match award in the 2006 final?",
        "answers": [
            {"text": "Aidan Fogarty", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "T.J. Reid", "correct": false}
        ]
    },
    {
        "question": "Who had the longest puckouts in the game during his time?",
        "answers": [
            {"text": "Ollie Walsh", "correct": true},
            {"text": "Noel Skehan", "correct": false},
            {"text": "Eoin Murphy", "correct": false},
            {"text": "James McGarry", "correct": false}
        ]
    },
    {
        "question": "Who is the Kilkenny player with eight All-Ireland medals but just two All-Stars?",
        "answers": [
            {"text": "Eoin Larkin", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "T.J. Reid", "correct": false},
            {"text": "Richie Hogan", "correct": false}
        ]
    },{
        "question": "Who scored Kilkenny's only goal in the 2006 final, which ensured the victory?",
        "answers": [
            {"text": "Aidan Fogarty", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "T.J. Reid", "correct": false}
        ]
    },
    {
        "question": "In 2008, who was named Hurler of the Year, having scored 1-4 in the final?",
        "answers": [
            {"text": "Eoin Larkin", "correct": true},
            {"text": "Richie Hogan", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Aidan Fogarty", "correct": false}
        ]
    },
    {
        "question": "Who was Kilkenny's top scorer in the championship with a total of 2-12 in 1979?",
        "answers": [
            {"text": "Mick 'Cloney' Brennan", "correct": true},
            {"text": "Eddie Keher", "correct": false},
            {"text": "Billy Fitzpatrick", "correct": false},
            {"text": "D.J. Carey", "correct": false}
        ]
    },
    {
        "question": "Which player scored 2-4 in the 2008 All-Ireland final, showcasing his versatility?",
        "answers": [
            {"text": "Eddie Brennan", "correct": true},
            {"text": "Richie Power", "correct": false},
            {"text": "Martin Comerford", "correct": false},
            {"text": "Colin Fennelly", "correct": false}
        ]
    },
    {
        "question": "Who captained Kilkenny in the three-in-a-row in 2008, showcasing leadership and skill?",
        "answers": [
            {"text": "James 'Cha' Fitzpatrick", "correct": true},
            {"text": "T.J. Reid", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Eoin Larkin", "correct": false}
        ]
    },
    {
        "question": "Which player scored a memorable goal in the 2012 semi-final against Tipperary from far out the field?",
        "answers": [
            {"text": "Eddie Brennan", "correct": true},
            {"text": "Richie Hogan", "correct": false},
            {"text": "Aidan Fogarty", "correct": false},
            {"text": "Eoin Larkin", "correct": false}
        ]
    },
    {
        "question": "Who patented the 'Delaney bounce', a unique hurling technique?",
        "answers": [
            {"text": "Pat Delaney", "correct": true},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "Richie Hogan", "correct": false},
            {"text": "D.J. Carey", "correct": false}
        ]
    },
    {
        "question": "Who is known for a unique grip on the hurl and scored 1-3 in a Man of the Match performance in the 2006 final?",
        "answers": [
            {"text": "Aidan Fogarty", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "T.J. Reid", "correct": false}
        ]
    },
    {
        "question": "Which player has been fouled as often as Colin Fennelly, known for his tireless work and ability to draw fouls?",
        "answers": [
            {"text": "Colin Fennelly", "correct": true},
            {"text": "Richie Hogan", "correct": false},
            {"text": "Eoin Larkin", "correct": false},
            {"text": "Walter Walsh", "correct": false}
        ]
    },
    {
        "question": "Who was the first Kilkenny player to be awarded an All-Star in 1971?",
        "answers": [
            {"text": "Jim Treacy", "correct": true},
            {"text": "Brian Cody", "correct": false},
            {"text": "Eddie Keher", "correct": false},
            {"text": "Pat Delaney", "correct": false}
        ]
    },
    {
        "question": "Which player scored the equalising point in the last minute of the 1993 Leinster final against Wexford?",
        "answers": [
            {"text": "Christy Heffernan", "correct": true},
            {"text": "D.J. Carey", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Eoin Larkin", "correct": false}
        ]
    },
    {
        "question": "Who was named Hurler of the Year in 1983, showcasing exceptional strength and skill?",
        "answers": [
            {"text": "Frank Cummins", "correct": true},
            {"text": "Eddie Keher", "correct": false},
            {"text": "Richie Power", "correct": false},
            {"text": "T.J. Reid", "correct": false}
        ]
    },
    {
        "question": "Which player demonstrated exceptional skill and determination to score 1-10 in the 2009 League Final?",
        "answers": [
            {"text": "Richie Hogan", "correct": true},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "D.J. Carey", "correct": false}
        ]
    },
    {
        "question": "Who was known for his ability to pass the ball accurately with his hurl one-handed?",
        "answers": [
            {"text": "Willie O'Connor", "correct": true},
            {"text": "Jackie Tyrrell", "correct": false},
            {"text": "Tommy Walsh", "correct": false},
            {"text": "Brian Cody", "correct": false}
        ]
    },
    {
        "question": "Which player scored a crucial goal in the second half of the 1972 All-Ireland final against Cork?",
        "answers": [
            {"text": "Frank Cummins", "correct": true},
            {"text": "Eddie Keher", "correct": false},
            {"text": "Pat Delaney", "correct": false},
            {"text": "Richie Power", "correct": false}
        ]
    },
    {
        "question": "Who was the player with a natural ciotÃ³g and considered the physically strongest hurler by many?",
        "answers": [
            {"text": "Frank Cummins", "correct": true},
            {"text": "Richie Hogan", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "D.J. Carey", "correct": false}
        ]
    },
    {
        "question": "Who captained Kilkenny to All-Ireland glory in 1975 and also won an under-21 All-Ireland a month later?",
        "answers": [
            {"text": "Billy Fitzpatrick", "correct": true},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "Mick Crotty", "correct": false},
            {"text": "D.J. Carey", "correct": false}
        ]
    },
    {
        "question": "Which player was awarded the Man of the Match in the 2007 All-Ireland final after scoring 1-5?",
        "answers": [
            {"text": "Eddie Brennan", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "Richie Hogan", "correct": false},
            {"text": "T.J. Reid", "correct": false}
        ]
    },
    {
        "question": "Who demonstrated exceptional freetaking skills and a goal-scoring ability, making them one of the most memorable hurlers?",
        "answers": [
            {"text": "Eddie Keher", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "D.J. Carey", "correct": false},
            {"text": "Richie Power", "correct": false}
        ]
    },
    {
        "question": "Which player was known for scoring important goals, including one in the 2006 final that kickstarted a four-in-a-row?",
        "answers": [
            {"text": "Aidan Fogarty", "correct": true},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "T.J. Reid", "correct": false}
        ]
    },
    {
        "question": "Which Kilkenny player, known for his ferocious work rate, was pivotal in the 2011 final replay against Tipperary with his scoring?",
        "answers": [
            {"text": "Richie Hogan", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "T.J. Reid", "correct": false},
            {"text": "Michael Fennelly", "correct": false}
        ]
    },
    {
        "question": "In what year did a Kilkenny player first achieve the feat of scoring from play in every line on the field during the championship season?",
        "answers": [
            {"text": "2000", "correct": true},
            {"text": "1995", "correct": false},
            {"text": "2005", "correct": false},
            {"text": "2010", "correct": false}
        ]
    },
    {
        "question": "Who was the youngest player to captain Kilkenny to an All-Ireland victory and in what year?",
        "answers": [
            {"text": "D.J. Carey, 1992", "correct": true},
            {"text": "Henry Shefflin, 2007", "correct": false},
            {"text": "T.J. Reid, 2015", "correct": false},
            {"text": "Eoin Larkin, 2008", "correct": false}
        ]
    },
    {
        "question": "Which player holds the record for the most championship appearances for Kilkenny?",
        "answers": [
            {"text": "Henry Shefflin", "correct": true},
            {"text": "Tommy Walsh", "correct": false},
            {"text": "J.J. Delaney", "correct": false},
            {"text": "Richie Hogan", "correct": false}
        ]
    },
    {
        "question": "Who is the only Kilkenny player to have won All-Star awards in three different positions?",
        "answers": [
            {"text": "Tommy Walsh", "correct": true},
            {"text": "Henry Shefflin", "correct": false},
            {"text": "D.J. Carey", "correct": false},
            {"text": "Richie Hogan", "correct": false}
        ]
    },
    {
        "question": "What unique feat did Kilkenny achieve in the 2008 hurling season?",
        "answers": [
            {"text": "Three-in-a-row All-Ireland titles", "correct": false},
            {"text": "Unbeaten in all competitions", "correct": true},
            {"text": "All forwards scored in the All-Ireland final", "correct": false},
            {"text": "Won both Senior and Minor All-Ireland titles", "correct": false}
        ]
    },
    {
        "question": "Who scored the winning point in the 2012 All-Ireland final replay against Galway?",
        "answers": [
            {"text": "Henry Shefflin", "correct": true},
            {"text": "Richie Hogan", "correct": false},
            {"text": "T.J. Reid", "correct": false},
            {"text": "Eoin Larkin", "correct": false}
        ]
    },
    {
        "question": "Which Kilkenny player was the first to win the Hurler of the Year award twice?",
        "answers": [
            {"text": "Henry Shefflin", "correct": true},
            {"text": "D.J. Carey", "correct": false},
            {"text": "Eddie Keher", "correct": false},
            {"text": "Brian Cody", "correct": false}
        ]
    },
    {
        "question": "What is the record number of points scored by a Kilkenny player in a single championship match?",
        "answers": [
            {"text": "17", "correct": true},
            {"text": "14", "correct": false},
            {"text": "12", "correct": false},
            {"text": "15", "correct": false}
        ]
    },
    {
        "question": "Who was the first player in hurling history to captain his county to an All-Ireland while also managing the team?",
        "answers": [
            {"text": "Brian Cody", "correct": true},
            {"text": "D.J. Carey", "correct": false},
            {"text": "Eddie Keher", "correct": false},
            {"text": "Henry Shefflin", "correct": false}
        ]
    },
    {
        "question": "Which Kilkenny player has the distinction of winning the most Man of the Match awards in All-Ireland finals?",
        "answers": [
            {"text": "Henry Shefflin", "correct": true},
            {"text": "Eddie Brennan", "correct": false},
            {"text": "Richie Hogan", "correct": false},
            {"text": "T.J. Reid", "correct": false}
        ]
    },

];

// Shuffle array (generic shuffle function)
function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
}

// Assuming currentQuestionIndex is declared elsewhere and set to 0 initially
function showQuestion() {
    // Only shuffle the questions once at the beginning
    if (currentQuestionIndex === 0) {
        shuffleArray(questions);
    }
    
    const question = questions[currentQuestionIndex];
    const questionElement = document.getElementById("question");
    questionElement.innerHTML = `Question ${currentQuestionIndex + 1}: ${question.question}`;
    const answerButtonsElement = document.getElementById("answer-buttons");
    answerButtonsElement.innerHTML = '';

    // Shuffle answers for the current question
    let answers = [...question.answers];
    shuffleArray(answers);

    answers.forEach(answer => {
        const button = document.createElement("button");
        button.innerText = answer.text;
        button.classList.add("btn", "btn-secondary", "mb-2");
        // Set data-correct attribute based on the answer's correctness
        button.dataset.correct = answer.correct;
        button.addEventListener('click', () => selectAnswer(answer.correct, button));
        answerButtonsElement.appendChild(button);
    });
}


let currentQuestionIndex = 0;
let score = 0;
let timer;
let timeLeft = 30; // 30 seconds for the countdown


document.addEventListener('DOMContentLoaded', () => {
    document.getElementById('start-btn').addEventListener('click', startQuiz);
    document.getElementById('leaderboard-overlay').addEventListener('click', hideLeaderboard);
    // Prevent the overlay from closing when clicking inside the leaderboard
    document.querySelector('.leaderboard').addEventListener('click', (e) => e.stopPropagation());
});

function startQuiz() {
    currentQuestionIndex = 0;
    score = 0;
    timeLeft = 30; // Reset the timer
    document.querySelector('.quiz-container').style.backgroundImage = 'none'; // Remove the background image again if needed
    document.querySelector('.app-background').style.animation = 'none'; // Stop the pulsing animation effect if needed
    document.getElementById('click-message').style.display = 'none'; // Hide the "Click to Start" message again if needed
    document.querySelector('.quiz').style.display = 'block'; // Make sure the quiz container is shown
    showQuestion(); // Display the first question
    timer = setInterval(updateTimer, 1000); // Restart the timer
}


document.getElementById('click-message').addEventListener('click', function() {
    currentQuestionIndex = 0;
    score = 0;
    // Stop the pulsing animation effect
    // Remove the background image from the quiz-container
    document.querySelector('.quiz-container').style.backgroundImage = 'none';

    // Stop the pulsing animation effect
    document.querySelector('.quiz-container').style.animation = 'none';


    // Hide the "Click to Start" message
    this.style.display = 'none';

    // Show the quiz content if hidden
    document.querySelector('.quiz').style.display = 'block';
    showQuestion();
    timeLeft = 30; // Reset the timer each time the quiz starts
    timer = setInterval(updateTimer, 1000); // Start the timer, calling updateTimer every second
});


function updateTimer() {
    timeLeft--;
    const timerElement = document.getElementById('timer');
    timerElement.innerText = `Time Left: ${timeLeft}s`;

    // Clear previous classes
    timerElement.classList.remove('timer-green', 'timer-yellow', 'timer-red', 'timer-blink');

    // Apply new class based on the time left
    if (timeLeft > 20) {
        timerElement.classList.add('timer-green');
    } else if (timeLeft > 10 && timeLeft <= 20) {
        timerElement.classList.add('timer-yellow');
    } else if (timeLeft > 5 && timeLeft <= 10) {
        timerElement.classList.add('timer-red');
    } else if (timeLeft <= 5) {
        timerElement.classList.add('timer-red', 'timer-blink');
    }

    if (timeLeft <= 0) {
        clearInterval(timer); // Stop the timer
        endGame(); // End the game when time runs out
    }
}


function selectAnswer(correct, button) {
    // Play sound based on the correctness of the selected answer
    if (correct) {
        score++;
        dingSound();
        button.classList.add('correct');
    } else {
        wrongSound();
        button.classList.add('incorrect');
    }

    // Iterate over all answer buttons to reveal correct and incorrect answers
    const answerButtonsElement = document.getElementById("answer-buttons");
    Array.from(answerButtonsElement.children).forEach(btn => {
        // Disable the button
        btn.disabled = true;

        // Reveal which buttons are correct or incorrect
        if (btn.dataset.correct === "true") {
            btn.classList.add("correct");
        } else {
            btn.classList.add("incorrect");
        }
    });

    // Show the next button
    document.getElementById('next-btn').style.display = 'block';
}



document.getElementById('next-btn').addEventListener('click', () => {
    currentQuestionIndex++;
    showQuestion();
});

function endGame() {
    clearInterval(timer); // Stop the timer
    document.querySelector('.quiz').style.display = 'none'; // Hide the quiz container
    
    // Show the custom modal to enter username
    document.getElementById('username-modal').style.display = "block";
    
    // Setup save username button click event
    document.getElementById("save-username").onclick = function() {
        var username = document.getElementById('username-input').value;
        if (username) {
            saveScore(username, score);
            // After saving score, hide the modal and clear the input
            document.getElementById('username-modal').style.display = "none";
            document.getElementById('username-input').value = '';
            
            // Show the game over section with the play again and leaderboard options
            showGameOverSection();
        }
    };

    // Close modal when clicking on the close button
    document.getElementsByClassName("close-button")[0].onclick = function() {
        document.getElementById('username-modal').style.display = "none";
    };

    // Close modal when clicking outside of it
    window.onclick = function(event) {
        if (event.target == document.getElementById('username-modal')) {
            document.getElementById('username-modal').style.display = "none";
        }
    };
}





function showLeaderboardOverlay() {
    displayLeaderboard(); // Make sure this function populates the leaderboard
    document.getElementById('leaderboard-overlay').style.display = 'flex';
}


function restartQuiz() {
    clearInterval(timer); // Stop any existing timer to prevent multiple instances
    document.getElementById('game-over').style.display = 'none'; // Hide the game over section
    document.getElementById('click-message').style.display = 'block'; // Show the "Click to Start" message again
    // Optionally, reset other UI elements to their initial states here
    startQuiz(); // Initialize the quiz again
}




function displayEndGameOptions() {
    // Optionally prompt for username and save score here if needed
    document.getElementById('game-over').style.display = 'block';
}

function saveScore(username, score) {
    const leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
    leaderboard.push({ username, score });
    // Sort the leaderboard by score in descending order
    leaderboard.sort((a, b) => b.score - a.score);
    // Optional: Keep only the top 5 scores, or adjust the number as needed
    const updatedLeaderboard = leaderboard.slice(0, 5);
    localStorage.setItem('leaderboard', JSON.stringify(updatedLeaderboard));
    displayLeaderboard(); // Refresh the leaderboard display
}


function showLeaderboardOverlay() {
    const overlay = document.getElementById('leaderboard-overlay');
    overlay.style.display = 'flex';
    displayLeaderboard(); // Make sure this function populates the leaderboard
}


function hideLeaderboard() {
    document.getElementById('leaderboard-overlay').style.display = 'none';
}


function displayLeaderboard() {
    const leaderboardDiv = document.querySelector('#leaderboard-overlay .leaderboard');
    const leaderboard = JSON.parse(localStorage.getItem('leaderboard')) || [];
    let leaderboardHTML = '<h2>Leaderboard</h2><table class="table"><thead><tr><th>Rank</th><th>Username</th><th>Score</th></tr></thead><tbody>';
    
    leaderboard.forEach((entry, index) => {
        leaderboardHTML += `<tr><td>${index + 1}</td><td>${entry.username}</td><td>${entry.score}</td></tr>`;
    });
    
    leaderboardHTML += '</tbody></table>';
    leaderboardDiv.innerHTML = leaderboardHTML;
}


// Sounds
function dingSound() {
    const sound = new Audio('sounds/ding.mp3');
    sound.play();
}

function wrongSound() {
    const sound = new Audio('sounds/wrong-answer.mp3');
    sound.play();
}

document.getElementById('floating-message').addEventListener('click', function() {
    this.style.display = 'none';
});

// Save username and show game over section
document.getElementById("save-username").onclick = function() {
    var username = document.getElementById('username-input').value.trim();
    if (username) {
        saveScore(username, score);
    }
    // Close the modal
    document.getElementById('username-modal').style.display = "none";
    // Show the game over section regardless of username input
    showGameOverSection();
};

// Close modal when clicking outside and show game over section
window.onclick = function(event) {
    if (event.target == document.getElementById('username-modal')) {
        document.getElementById('username-modal').style.display = "none";
        // Ensure game over section is shown even if no username was entered
        showGameOverSection();
    }
};

// Function to show the game over section
function showGameOverSection() {
    const gameOverSection = document.getElementById('game-over');
    gameOverSection.innerHTML = `
        <div style="text-align: center;">
            <h2>Your score: ${score}</h2>
            <button class="btn btn-info" onclick="restartQuiz()">Play Again</button>
            <button class="btn btn-secondary" onclick="showLeaderboardOverlay()">Leaderboard</button>
        </div>
    `;
    gameOverSection.style.display = 'block';
}